<h1>メンバー確認</h1>
<%= link_to "新しいメンバーを追加", new_member_path %>

<% if @members.present? %>
  <% @members.each do |member| %>
    <br><%= member.name %>
    <br><%= member.rating %>
    <%= link_to "メンバー削除", member_path(member), data: { turbo_method: :delete, turbo_confirm: '削除しますか?' } %>
    <% if member.already_participation? %>
    参加中
      <%= button_to member_participations_path(member), method: :delete, data: { turbo_method: :delete } do %>
        不参加にする
      <% end %>
    <% else %>
      <%= button_to member_participations_path(member), method: :post, data: { turbo_method: :post } do %>
        参加にする
      <% end %>
    <% end %>
  <% end %>
<% else %>
  <p>メンバーが存在しません。</p>
<% end %>

<%= form_with(model: @match, url: matches_path, method: :post) do |form| %>
  <%= form.label :coat %>
  <%= form.select :coat, (1..4).to_a %>

  <% # プルダウンからの選択ではなく、既に参加しているメンバーだけのIDを登録 %>
  <%#= form.fields_for :member do |member_form| %>
    <%#= form.hidden_field :member_id, value: @member_ids.any? ? @member_ids.join(',') : nil %>
  <%# end %>

  <%= form.submit "試合作成" %>
<% end %>

<%= link_to "試合一覧", matches_path %>


